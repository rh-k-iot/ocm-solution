<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCM - Oasis Client Manager v2.0</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & Babel -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Custom Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- ë¡œë”© ìŠ¤í¬ë¦° -->
    <div id="loading-screen" class="fixed inset-0 bg-white flex items-center justify-center z-50">
        <div class="text-center">
            <div class="loading-spinner rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-4"></div>
            <h2 class="text-xl font-semibold text-gray-800">OCM ì‹œìŠ¤í…œ ë¡œë”© ì¤‘...</h2>
            <p class="text-gray-600 mt-2">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</p>
            <div id="loading-progress" class="mt-4 text-sm text-gray-500"></div>
        </div>
    </div>

    <!-- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ -->
    <div id="root" class="hidden"></div>

    <!-- ì—ëŸ¬ í‘œì‹œ ì˜ì—­ -->
    <div id="error-container" class="hidden fixed inset-0 bg-red-50 flex items-center justify-center z-40">
        <div class="bg-white p-8 rounded-lg shadow-lg max-w-md w-full">
            <div class="text-red-600 text-6xl text-center mb-4">âš ï¸</div>
            <h2 class="text-xl font-bold text-red-800 text-center mb-4">ì‹œìŠ¤í…œ ì˜¤ë¥˜</h2>
            <p id="error-message" class="text-red-600 text-center mb-6"></p>
            <div class="flex justify-center space-x-3">
                <button onclick="location.reload()" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700">
                    ìƒˆë¡œê³ ì¹¨
                </button>
                <button onclick="window.OCM_DEBUG?.resetData()" class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700">
                    ë°ì´í„° ì´ˆê¸°í™”
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================
         Core System Scripts
         ======================================== -->
    
    <!-- 1. Core Configuration -->
    <script type="text/babel">
        // Core configuration and constants (from ocm_core_config)
        const OCM_CONFIG = {
            version: '2.0.0',
            name: 'Oasis Client Manager',
            description: 'ì˜¤ì•„ì‹œìŠ¤ í´ë¼ì´ì–¸íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œ',
            
            api: {
                baseUrl: '',
                timeout: 30000,
                retries: 3
            },
            
            storage: {
                prefix: 'ocm_v2_',
                compression: false,
                encryption: false,
                autoBackup: true
            },
            
            ui: {
                theme: 'default',
                animations: true,
                pageSize: 10
            }
        };

        const OCM_CONSTANTS = {
            STORAGE_KEYS: {
                CLIENTS: 'clients',
                PROJECTS: 'projects',
                QUOTES: 'quotes',
                CONTRACTS: 'contracts',
                TRANSACTIONS: 'transactions',
                SETTLEMENTS: 'settlements'
            },
            
            PROJECT_STATUS: {
                RECEIVED: 'received',
                QUOTED: 'quoted',
                CONTRACTED: 'contracted',
                IN_PROGRESS: 'in_progress',
                COMPLETED: 'completed',
                CANCELLED: 'cancelled'
            },
            
            STATUS_TEXT: {
                received: 'ì ‘ìˆ˜ë¨',
                quoted: 'ê²¬ì ë°œì†¡',
                contracted: 'ê³„ì•½ì²´ê²°',
                in_progress: 'ì§„í–‰ì¤‘',
                completed: 'ì™„ë£Œ',
                cancelled: 'ì·¨ì†Œë¨'
            },
            
            STATUS_COLORS: {
                received: 'bg-blue-100 text-blue-800 border-blue-200',
                quoted: 'bg-yellow-100 text-yellow-800 border-yellow-200',
                contracted: 'bg-green-100 text-green-800 border-green-200',
                in_progress: 'bg-purple-100 text-purple-800 border-purple-200',
                completed: 'bg-gray-100 text-gray-800 border-gray-200',
                cancelled: 'bg-red-100 text-red-800 border-red-200'
            },
            
            PROJECT_TYPES: [
                { value: 'product_design', label: 'ì œí’ˆ ì„¤ê³„', icon: 'ğŸ¨' },
                { value: 'prototype', label: 'ì‹œì œí’ˆ ì œì‘', icon: 'ğŸ”§' },
                { value: 'consulting', label: 'ì»¨ì„¤íŒ…', icon: 'ğŸ’¡' },
                { value: 'web_development', label: 'ì›¹ê°œë°œ', icon: 'ğŸ’»' },
                { value: 'mobile_app', label: 'ëª¨ë°”ì¼ì•±', icon: 'ğŸ“±' },
                { value: 'iot_solution', label: 'IoT ì†”ë£¨ì…˜', icon: 'ğŸŒ' },
                { value: 'other', label: 'ê¸°íƒ€', icon: 'ğŸ“¦' }
            ],

            BUDGET_RANGES: [
                { value: 'under_1m', label: '100ë§Œì› ì´í•˜', min: 0, max: 1000000 },
                { value: '1m_5m', label: '100ë§Œì› - 500ë§Œì›', min: 1000000, max: 5000000 },
                { value: '5m_10m', label: '500ë§Œì› - 1000ë§Œì›', min: 5000000, max: 10000000 },
                { value: '10m_50m', label: '1000ë§Œì› - 5000ë§Œì›', min: 10000000, max: 50000000 },
                { value: '50m_100m', label: '5000ë§Œì› - 1ì–µì›', min: 50000000, max: 100000000 },
                { value: 'over_100m', label: '1ì–µì› ì´ìƒ', min: 100000000, max: Infinity }
            ],

            PRIORITY_LEVELS: {
                LOW: 'low',
                MEDIUM: 'medium',
                HIGH: 'high',
                URGENT: 'urgent'
            },

            PRIORITY_TEXT: {
                low: 'ë‚®ìŒ',
                medium: 'ë³´í†µ',
                high: 'ë†’ìŒ',
                urgent: 'ê¸´ê¸‰'
            },

            PRIORITY_COLORS: {
                low: 'bg-gray-100 text-gray-800',
                medium: 'bg-blue-100 text-blue-800',
                high: 'bg-yellow-100 text-yellow-800',
                urgent: 'bg-red-100 text-red-800'
            }
        };

        // ì „ì—­ ê°ì²´ì— ì„¤ì •
        window.OCM_CONFIG = OCM_CONFIG;
        window.OCM_CONSTANTS = OCM_CONSTANTS;

        console.log('âœ… Core Configuration ë¡œë“œ ì™„ë£Œ');
    </script>

    <!-- 2. Base Storage System -->
    <script type="text/babel">
        // Base Storage Class (simplified version of ocm_base_storage)
        class BaseStorage {
            constructor(storageKey, options = {}) {
                this.storageKey = storageKey;
                this.options = { autoSave: true, validation: true, ...options };
                this.data = this._loadData();
                this.listeners = new Set();
            }

            getAll() {
                return [...this.data];
            }

            getById(id) {
                return this.data.find(item => item.id === id) || null;
            }

            getWhere(predicate) {
                return this.data.filter(predicate);
            }

            create(itemData) {
                if (this.options.validation) {
                    this.validate(itemData);
                }

                const newItem = {
                    ...itemData,
                    id: itemData.id || this._generateId(),
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (this.getById(newItem.id)) {
                    throw new Error(`ì¤‘ë³µëœ IDì…ë‹ˆë‹¤: ${newItem.id}`);
                }

                this.data.push(newItem);
                this._save();
                this._notifyListeners('create', newItem);
                return newItem;
            }

            update(id, updates) {
                const index = this.data.findIndex(item => item.id === id);
                if (index === -1) {
                    throw new Error(`ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${id}`);
                }

                const updatedItem = {
                    ...this.data[index],
                    ...updates,
                    id,
                    updatedAt: new Date().toISOString()
                };

                if (this.options.validation) {
                    this.validate(updatedItem);
                }

                this.data[index] = updatedItem;
                this._save();
                this._notifyListeners('update', updatedItem);
                return updatedItem;
            }

            delete(id) {
                const index = this.data.findIndex(item => item.id === id);
                if (index === -1) return false;

                const deletedItem = this.data[index];
                this.data.splice(index, 1);
                this._save();
                this._notifyListeners('delete', deletedItem);
                return true;
            }

            exists(id) {
                return this.data.some(item => item.id === id);
            }

            count() {
                return this.data.length;
            }

            clear() {
                this.data = [];
                this._save();
                this._notifyListeners('clear', []);
            }

            subscribe(listener) {
                this.listeners.add(listener);
                return () => this.listeners.delete(listener);
            }

            validate(data) {
                // ì„œë¸Œí´ë˜ìŠ¤ì—ì„œ êµ¬í˜„
            }

            _loadData() {
                try {
                    const key = `${OCM_CONFIG.storage.prefix}${this.storageKey}`;
                    const stored = localStorage.getItem(key);
                    return stored ? JSON.parse(stored) : [];
                } catch (error) {
                    console.error(`[${this.storageKey}] ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:`, error);
                    return [];
                }
            }

            _save() {
                try {
                    const key = `${OCM_CONFIG.storage.prefix}${this.storageKey}`;
                    localStorage.setItem(key, JSON.stringify(this.data));
                } catch (error) {
                    console.error(`[${this.storageKey}] ë°ì´í„° ì €ì¥ ì˜¤ë¥˜:`, error);
                    throw error;
                }
            }

            _generateId() {
                return `${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            }

            _notifyListeners(action, data) {
                this.listeners.forEach(listener => {
                    try {
                        listener(action, data, this.storageKey);
                    } catch (error) {
                        console.error('ë¦¬ìŠ¤ë„ˆ ì‹¤í–‰ ì˜¤ë¥˜:', error);
                    }
                });
            }
        }

        // Storage Manager
        class StorageManager {
            constructor() {
                this.storages = new Map();
            }

            register(name, storage) {
                this.storages.set(name, storage);
            }

            get(name) {
                return this.storages.get(name) || null;
            }
        }

        // ì „ì—­ ìŠ¤í† ë¦¬ì§€ ë§¤ë‹ˆì € ìƒì„±
        window.OCM_STORAGE_MANAGER = new StorageManager();
        window.OCM_BASE_STORAGE = { BaseStorage, StorageManager };

        console.log('âœ… Base Storage System ë¡œë“œ ì™„ë£Œ');
    </script>

    <!-- 3. Client Management Module -->
    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Client Storage
        class ClientStorage extends BaseStorage {
            constructor() {
                super('clients');
            }

            validate(data) {
                const required = ['companyName', 'contactPerson', 'email', 'phone'];
                const missing = required.filter(field => !data[field]);
                
                if (missing.length > 0) {
                    throw new Error(`í•„ìˆ˜ í•„ë“œê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤: ${missing.join(', ')}`);
                }

                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(data.email)) {
                    throw new Error('ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.');
                }
            }

            getByEmail(email) {
                return this.getWhere(client => 
                    client.email.toLowerCase() === email.toLowerCase()
                )[0] || null;
            }
        }

        // Client Service
        class ClientService {
            constructor(storage) {
                this.storage = storage;
            }

            async createClient(clientData) {
                const existingClient = this.storage.getByEmail(clientData.email);
                if (existingClient) {
                    throw new Error('ì´ë¯¸ ë“±ë¡ëœ ì´ë©”ì¼ì…ë‹ˆë‹¤.');
                }

                const newClient = {
                    ...clientData,
                    clientType: clientData.clientType || 'corporate',
                    status: 'active'
                };

                return this.storage.create(newClient);
            }

            async updateClient(id, updates) {
                return this.storage.update(id, updates);
            }

            async deleteClient(id) {
                return this.storage.delete(id);
            }

            searchClients(searchParams) {
                const { query, clientType, status } = searchParams;
                let results = this.storage.getAll();

                if (query) {
                    const lowerQuery = query.toLowerCase();
                    results = results.filter(client => 
                        client.companyName.toLowerCase().includes(lowerQuery) ||
                        client.contactPerson.toLowerCase().includes(lowerQuery) ||
                        client.email.toLowerCase().includes(lowerQuery)
                    );
                }

                if (clientType) {
                    results = results.filter(client => client.clientType === clientType);
                }

                if (status) {
                    results = results.filter(client => client.status === status);
                }

                return results;
            }
        }

        // Client Management Component
        const ClientManagement = () => {
            const [clients, setClients] = useState([]);
            const [currentView, setCurrentView] = useState('list');
            const [selectedClient, setSelectedClient] = useState(null);
            const [loading, setLoading] = useState(true);

            const clientService = useMemo(() => {
                const storage = new ClientStorage();
                window.OCM_STORAGE_MANAGER.register('clients', storage);
                return new ClientService(storage);
            }, []);

            useEffect(() => {
                loadClients();
            }, []);

            const loadClients = async () => {
                try {
                    setLoading(true);
                    const allClients = clientService.storage.getAll();
                    setClients(allClients);
                } catch (error) {
                    console.error('í´ë¼ì´ì–¸íŠ¸ ë¡œë“œ ì˜¤ë¥˜:', error);
                } finally {
                    setLoading(false);
                }
            };

            const handleCreateClient = () => {
                setSelectedClient(null);
                setCurrentView('form');
            };

            const handleSaveClient = async (clientData) => {
                try {
                    if (selectedClient) {
                        await clientService.updateClient(selectedClient.id, clientData);
                    } else {
                        await clientService.createClient(clientData);
                    }
                    await loadClients();
                    setCurrentView('list');
                } catch (error) {
                    throw error;
                }
            };

            if (loading) {
                return (
                    <div className="flex justify-center items-center h-64">
                        <div className="loading-spinner rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
                        <span className="ml-3 text-gray-600">í´ë¼ì´ì–¸íŠ¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
                    </div>
                );
            }

            if (currentView === 'form') {
                return React.createElement(ClientForm, {
                    client: selectedClient,
                    onSave: handleSaveClient,
                    onCancel: () => setCurrentView('list')
                });
            }

            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <div>
                            <h1 className="text-2xl font-bold text-gray-900">í´ë¼ì´ì–¸íŠ¸ ê´€ë¦¬</h1>
                            <p className="text-gray-600 mt-1">ì´ {clients.length}ê°œì˜ í´ë¼ì´ì–¸íŠ¸</p>
                        </div>
                        <button
                            onClick={handleCreateClient}
                            className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center space-x-2"
                        >
                            <span>â•</span>
                            <span>ìƒˆ í´ë¼ì´ì–¸íŠ¸</span>
                        </button>
                    </div>

                    <div className="bg-white shadow rounded-lg overflow-hidden">
                        {clients.length === 0 ? (
                            <div className="text-center py-12">
                                <div className="text-gray-400 text-6xl mb-4">ğŸ‘¥</div>
                                <h3 className="text-lg font-medium text-gray-900 mb-2">ë“±ë¡ëœ í´ë¼ì´ì–¸íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
                                <p className="text-gray-500">ì²« ë²ˆì§¸ í´ë¼ì´ì–¸íŠ¸ë¥¼ ë“±ë¡í•´ë³´ì„¸ìš”.</p>
                            </div>
                        ) : (
                            <div className="overflow-x-auto">
                                <table className="min-w-full divide-y divide-gray-200">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">íšŒì‚¬ëª…</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ë‹´ë‹¹ì</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ì´ë©”ì¼</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ì „í™”ë²ˆí˜¸</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ë“±ë¡ì¼</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ì‘ì—…</th>
                                        </tr>
                                    </thead>
                                    <tbody className="bg-white divide-y divide-gray-200">
                                        {clients.map(client => (
                                            <tr key={client.id} className="hover:bg-gray-50">
                                                <td className="px-6 py-4 whitespace-nowrap font-medium text-gray-900">
                                                    {client.companyName}
                                                </td>
                                                <td className="px-6 py-4 whitespace-nowrap text-gray-900">
                                                    {client.contactPerson}
                                                </td>
                                                <td className="px-6 py-4 whitespace-nowrap text-gray-600">
                                                    {client.email}
                                                </td>
                                                <td className="px-6 py-4 whitespace-nowrap text-gray-600">
                                                    {client.phone}
                                                </td>
                                                <td className="px-6 py-4 whitespace-nowrap text-gray-600">
                                                    {new Date(client.createdAt).toLocaleDateString('ko-KR')}
                                                </td>
                                                <td className="px-6 py-4 whitespace-nowrap text-right">
                                                    <button
                                                        onClick={() => {
                                                            setSelectedClient(client);
                                                            setCurrentView('form');
                                                        }}
                                                        className="text-blue-600 hover:text-blue-900 mr-3"
                                                    >
                                                        ìˆ˜ì •
                                                    </button>
                                                    <button
                                                        onClick={() => {
                                                            if (confirm('ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                                                                clientService.deleteClient(client.id);
                                                                loadClients();
                                                            }
                                                        }}
                                                        className="text-red-600 hover:text-red-900"
                                                    >
                                                        ì‚­ì œ
                                                    </button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // Client Form Component
        const ClientForm = ({ client, onSave, onCancel }) => {
            const [formData, setFormData] = useState({
                companyName: '',
                contactPerson: '',
                email: '',
                phone: '',
                website: '',
                address: '',
                clientType: 'corporate',
                notes: '',
                ...client
            });

            const [errors, setErrors] = useState({});
            const [isSubmitting, setIsSubmitting] = useState(false);

            const handleChange = (field, value) => {
                setFormData(prev => ({ ...prev, [field]: value }));
                if (errors[field]) {
                    setErrors(prev => ({ ...prev, [field]: null }));
                }
            };

            const validateForm = () => {
                const newErrors = {};

                if (!formData.companyName.trim()) {
                    newErrors.companyName = 'íšŒì‚¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                }
                if (!formData.contactPerson.trim()) {
                    newErrors.contactPerson = 'ë‹´ë‹¹ìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                }
                if (!formData.email.trim()) {
                    newErrors.email = 'ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                } else {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(formData.email)) {
                        newErrors.email = 'ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.';
                    }
                }
                if (!formData.phone.trim()) {
                    newErrors.phone = 'ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                }

                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!validateForm()) return;

                setIsSubmitting(true);
                try {
                    await onSave(formData);
                } catch (error) {
                    setErrors({ submit: error.message });
                } finally {
                    setIsSubmitting(false);
                }
            };

            return (
                <div className="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow">
                    <h2 className="text-2xl font-bold text-gray-900 mb-6">
                        {client ? 'í´ë¼ì´ì–¸íŠ¸ ìˆ˜ì •' : 'ìƒˆ í´ë¼ì´ì–¸íŠ¸ ë“±ë¡'}
                    </h2>

                    <form onSubmit={handleSubmit} className="space-y-6">
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-2">í´ë¼ì´ì–¸íŠ¸ ìœ í˜•</label>
                            <div className="flex space-x-4">
                                <label className="flex items-center">
                                    <input
                                        type="radio"
                                        name="clientType"
                                        value="corporate"
                                        checked={formData.clientType === 'corporate'}
                                        onChange={(e) => handleChange('clientType', e.target.value)}
                                        className="mr-2"
                                    />
                                    ê¸°ì—…
                                </label>
                                <label className="flex items-center">
                                    <input
                                        type="radio"
                                        name="clientType"
                                        value="individual"
                                        checked={formData.clientType === 'individual'}
                                        onChange={(e) => handleChange('clientType', e.target.value)}
                                        className="mr-2"
                                    />
                                    ê°œì¸
                                </label>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">íšŒì‚¬ëª… *</label>
                                <input
                                    type="text"
                                    value={formData.companyName}
                                    onChange={(e) => handleChange('companyName', e.target.value)}
                                    className={`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 ${
                                        errors.companyName ? 'border-red-500' : 'border-gray-300'
                                    }`}
                                    placeholder="íšŒì‚¬ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                                />
                                {errors.companyName && <p className="text-red-500 text-sm mt-1">{errors.companyName}</p>}
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">ë‹´ë‹¹ìëª… *</label>
                                <input
                                    type="text"
                                    value={formData.contactPerson}
                                    onChange={(e) => handleChange('contactPerson', e.target.value)}
                                    className={`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 ${
                                        errors.contactPerson ? 'border-red-500' : 'border-gray-300'
                                    }`}
                                    placeholder="ë‹´ë‹¹ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                                />
                                {errors.contactPerson && <p className="text-red-500 text-sm mt-1">{errors.contactPerson}</p>}
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">ì´ë©”ì¼ *</label>
                                <input
                                    type="email"
                                    value={formData.email}
                                    onChange={(e) => handleChange('email', e.target.value)}
                                    className={`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 ${
                                        errors.email ? 'border-red-500' : 'border-gray-300'
                                    }`}
                                    placeholder="example@company.com"
                                />
                                {errors.email && <p className="text-red-500 text-sm mt-1">{errors.email}</p>}
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">ì „í™”ë²ˆí˜¸ *</label>
                                <input
                                    type="tel"
                                    value={formData.phone}
                                    onChange={(e) => handleChange('phone', e.target.value)}
                                    className={`w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 ${
                                        errors.phone ? 'border-red-500' : 'border-gray-300'
                                    }`}
                                    placeholder="02-1234-5678"
                                />
                                {errors.phone && <p className="text-red-500 text-sm mt-1">{errors.phone}</p>}
                            </div>
                        </div>

                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">ì›¹ì‚¬ì´íŠ¸</label>
                            <input
                                type="url"
                                value={formData.website}
                                onChange={(e) => handleChange('website', e.target.value)}
                                className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
                                placeholder="https://www.company.com"
                            />
                        </div>

                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">ì£¼ì†Œ</label>
                            <textarea
                                value={formData.address}
                                onChange={(e) => handleChange('address', e.target.value)}
                                rows={2}
                                className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
                                placeholder="ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                            />
                        </div>

                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">ë©”ëª¨</label>
                            <textarea
                                value={formData.notes}
                                onChange={(e) => handleChange('notes', e.target.value)}
                                rows={3}
                                className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"
                                placeholder="ì¶”ê°€ ì •ë³´ë‚˜ íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”"
                            />
                        </div>

                        {errors.submit && (
                            <div className="bg-red-50 border border-red-200 rounded-md p-4">
                                <p className="text-red-800">{errors.submit}</p>
                            </div>
                        )}

                        <div className="flex justify-end space-x-3">
                            <button
                                type="button"
                                onClick={onCancel}
                                className="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"
                                disabled={isSubmitting}
                            >
                                ì·¨ì†Œ
                            </button>
                            <button
                                type="submit"
                                disabled={isSubmitting}
                                className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"
                            >
                                {isSubmitting ? 'ì €ì¥ ì¤‘...' : (client ? 'ìˆ˜ì •' : 'ë“±ë¡')}
                            </button>
                        </div>
                    </form>
                </div>
            );
        };

        // ì»´í¬ë„ŒíŠ¸ ë“±ë¡
        window.OCM_COMPONENTS = window.OCM_COMPONENTS || {};
        window.OCM_COMPONENTS.ClientManagement = ClientManagement;
        window.OCM_CLIENT_SERVICE = new ClientService(new ClientStorage());

        console.log('âœ… Client Management Module ë¡œë“œ ì™„ë£Œ');
    </script>

    <!-- 4. Dashboard Component -->
    <script type="text/babel">
        const Dashboard = () => {
            const [stats, setStats] = useState({
                totalClients: 0,
                totalProjects: 0,
                activeProjects: 0,
                completedProjects: 0,
                totalRevenue: 0,
                pendingQuotes: 0
            });
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                loadStats();
            }, []);

            const loadStats = async () => {
                try {
                    setLoading(true);
                    
                    const clientStorage = window.OCM_STORAGE_MANAGER?.get('clients');
                    const projectStorage = window.OCM_STORAGE_MANAGER?.get('projects');
                    
                    const clients = clientStorage ? clientStorage.getAll() : [];
                    const projects = projectStorage ? projectStorage.getAll() : [];
                    
                    const activeProjects = projects.filter(p => 
                        ['received', 'quoted', 'contracted', 'in_progress'].includes(p.status)
                    );
                    const completedProjects = projects.filter(p => p.status === 'completed');

                    setStats({
                        totalClients: clients.length,
                        totalProjects: projects.length,
                        activeProjects: activeProjects.length,
                        completedProjects: completedProjects.length,
                        totalRevenue: 0, // TODO: ê³„ì•½ ë°ì´í„°ì—ì„œ ê³„ì‚°
                        pendingQuotes: projects.filter(p => p.status === 'received').length
                    });
                } catch (error) {
                    console.error('í†µê³„ ë¡œë“œ ì˜¤ë¥˜:', error);
                } finally {
                    setLoading(false);
                }
            };

            if (loading) {
                return (
                    <div className="flex justify-center items-center h-64">
                        <div className="loading-spinner rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
                        <span className="ml-3 text-gray-600">ëŒ€ì‹œë³´ë“œ ë¡œë”© ì¤‘...</span>
                    </div>
                );
            }

            return (
                <div className="space-y-6">
                    <div>
                        <h1 className="text-2xl font-bold text-gray-900">ëŒ€ì‹œë³´ë“œ</h1>
                        <p className="text-gray-600 mt-1">OCM ì‹œìŠ¤í…œ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>
                    </div>

                    {/* í†µê³„ ì¹´ë“œ */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div className="bg-white p-6 rounded-lg shadow">
                            <div className="flex items-center">
                                <div className="flex-shrink-0">
                                    <div className="w-8 h-8 bg-blue-100 rounded-md flex items-center justify-center">
                                        <span className="text-blue-600 text-lg">ğŸ‘¥</span>
                                    </div>
                                </div>
                                <div className="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt className="text-sm font-medium text-gray-500 truncate">ì´ í´ë¼ì´ì–¸íŠ¸</dt>
                                        <dd className="text-lg font-medium text-gray-900">{stats.totalClients}</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow">
                            <div className="flex items-center">
                                <div className="flex-shrink-0">
                                    <div className="w-8 h-8 bg-green-100 rounded-md flex items-center justify-center">
                                        <span className="text-green-600 text-lg">ğŸ“‹</span>
                                    </div>
                                </div>
                                <div className="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt className="text-sm font-medium text-gray-500 truncate">ì§„í–‰ ì¤‘ì¸ í”„ë¡œì íŠ¸</dt>
                                        <dd className="text-lg font-medium text-gray-900">{stats.activeProjects}</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow">
                            <div className="flex items-center">
                                <div className="flex-shrink-0">
                                    <div className="w-8 h-8 bg-purple-100 rounded-md flex items-center justify-center">
                                        <span className="text-purple-600 text-lg">âœ…</span>
                                    </div>
                                </div>
                                <div className="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt className="text-sm font-medium text-gray-500 truncate">ì™„ë£Œëœ í”„ë¡œì íŠ¸</dt>
                                        <dd className="text-lg font-medium text-gray-900">{stats.completedProjects}</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow">
                            <div className="flex items-center">
                                <div className="flex-shrink-0">
                                    <div className="w-8 h-8 bg-yellow-100 rounded-md flex items-center justify-center">
                                        <span className="text-yellow-600 text-lg">ğŸ’°</span>
                                    </div>
                                </div>
                                <div className="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt className="text-sm font-medium text-gray-500 truncate">ëŒ€ê¸° ì¤‘ì¸ ê²¬ì </dt>
                                        <dd className="text-lg font-medium text-gray-900">{stats.pendingQuotes}</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* ë¹ ë¥¸ ì•¡ì…˜ */}
                    <div className="bg-white p-6 rounded-lg shadow">
                        <h3 className="text-lg font-medium text-gray-900 mb-4">ë¹ ë¥¸ ì•¡ì…˜</h3>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <button
                                onClick={() => window.OCM_APP?.setActiveTab('clients')}
                                className="p-4 bg-blue-50 hover:bg-blue-100 rounded-lg text-left transition-colors"
                            >
                                <div className="font-medium text-blue-700">ìƒˆ í´ë¼ì´ì–¸íŠ¸ ë“±ë¡</div>
                                <div className="text-sm text-blue-600">ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ ì˜ë¢°ë¥¼ ë“±ë¡í•˜ì„¸ìš”</div>
                            </button>
                            
                            <button
                                onClick={() => window.OCM_APP?.setActiveTab('projects')}
                                className="p-4 bg-green-50 hover:bg-green-100 rounded-lg text-left transition-colors"
                            >
                                <div className="font-medium text-green-700">í”„ë¡œì íŠ¸ ê´€ë¦¬</div>
                                <div className="text-sm text-green-600">ì§„í–‰ ì¤‘ì¸ í”„ë¡œì íŠ¸ë¥¼ í™•ì¸í•˜ì„¸ìš”</div>
                            </button>
                            
                            <button
                                onClick={() => alert('ê²¬ì ì„œ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.')}
                                className="p-4 bg-purple-50 hover:bg-purple-100 rounded-lg text-left transition-colors"
                            >
                                <div className="font-medium text-purple-700">ê²¬ì ì„œ ì‘ì„±</div>
                                <div className="text-sm text-purple-600">ìƒˆë¡œìš´ ê²¬ì ì„œë¥¼ ì‘ì„±í•˜ì„¸ìš”</div>
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        window.OCM_COMPONENTS.Dashboard = Dashboard;
        console.log('âœ… Dashboard Component ë¡œë“œ ì™„ë£Œ');
    </script>

    <!-- 5. Main Layout and Navigation -->
    <script type="text/babel">
        const MainLayout = ({ children, activeTab, onTabChange }) => {
            const tabs = [
                { id: 'dashboard', label: 'ëŒ€ì‹œë³´ë“œ', icon: 'ğŸ ' },
                { id: 'clients', label: 'í´ë¼ì´ì–¸íŠ¸', icon: 'ğŸ‘¥' },
                { id: 'projects', label: 'í”„ë¡œì íŠ¸', icon: 'ğŸ“‹' },
                { id: 'quotes', label: 'ê²¬ì ì„œ', icon: 'ğŸ’°' },
                { id: 'contracts', label: 'ê³„ì•½ì„œ', icon: 'ğŸ“„' },
                { id: 'transactions', label: 'ê±°ë˜ëª…ì„¸ì„œ', icon: 'ğŸ“Š' }
            ];

            return (
                <div className="min-h-screen bg-gray-100">
                    {/* í—¤ë” */}
                    <header className="bg-white shadow">
                        <div className="px-4 sm:px-6 lg:px-8">
                            <div className="flex justify-between items-center py-6">
                                <div className="flex items-center">
                                    <h1 className="text-2xl font-bold text-gray-900">
                                        OCM <span className="text-sm font-normal text-gray-500">v2.0</span>
                                    </h1>
                                </div>
                                <div className="text-sm text-gray-500">
                                    Oasis Client Manager
                                </div>
                            </div>
                        </div>
                    </header>

                    <div className="flex">
                        {/* ì‚¬ì´ë“œë°” */}
                        <div className="w-64 bg-white shadow-sm">
                            <nav className="mt-5 px-2">
                                <div className="space-y-1">
                                    {tabs.map(tab => (
                                        <button
                                            key={tab.id}
                                            onClick={() => onTabChange(tab.id)}
                                            className={`group flex items-center w-full px-2 py-2 text-sm font-medium rounded-md transition-colors ${
                                                activeTab === tab.id
                                                    ? 'bg-blue-100 text-blue-700'
                                                    : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'
                                            }`}
                                        >
                                            <span className="mr-3 text-lg">{tab.icon}</span>
                                            {tab.label}
                                        </button>
                                    ))}
                                </div>
                            </nav>
                        </div>

                        {/* ë©”ì¸ ì»¨í…ì¸  */}
                        <div className="flex-1">
                            <main className="py-6 px-4 sm:px-6 lg:px-8">
                                <div className="fade-in">
                                    {children}
                                </div>
                            </main>
                        </div>
                    </div>
                </div>
            );
        };

        window.OCM_COMPONENTS.MainLayout = MainLayout;
        console.log('âœ… Main Layout Component ë¡œë“œ ì™„ë£Œ');
    </script>

    <!-- 6. Main Application -->
    <script type="text/babel">
        const MainApp = () => {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [isInitialized, setIsInitialized] = useState(false);

            useEffect(() => {
                initializeApp();
            }, []);

            const initializeApp = async () => {
                try {
                    // ì‹œìŠ¤í…œ ì´ˆê¸°í™”
                    updateProgress('ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ í™•ì¸ ì¤‘...');
                    await new Promise(resolve => setTimeout(resolve, 500));

                    updateProgress('ë°ì´í„° ìŠ¤í† ë¦¬ì§€ ì´ˆê¸°í™” ì¤‘...');
                    await new Promise(resolve => setTimeout(resolve, 500));

                    updateProgress('ì»´í¬ë„ŒíŠ¸ ë¡œë”© ì¤‘...');
                    await new Promise(resolve => setTimeout(resolve, 500));

                    updateProgress('ì´ˆê¸°í™” ì™„ë£Œ!');
                    await new Promise(resolve => setTimeout(resolve, 500));

                    setIsInitialized(true);
                    hideLoadingScreen();
                } catch (error) {
                    console.error('ì•± ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
                    showError('ì‹œìŠ¤í…œ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
                }
            };

            const renderContent = () => {
                switch (activeTab) {
                    case 'dashboard':
                        return React.createElement(window.OCM_COMPONENTS.Dashboard);
                    case 'clients':
                        return React.createElement(window.OCM_COMPONENTS.ClientManagement);
                    case 'projects':
                        return <div className="text-center py-12 text-gray-500">í”„ë¡œì íŠ¸ ê´€ë¦¬ ê¸°ëŠ¥ ì¤€ë¹„ ì¤‘...</div>;
                    case 'quotes':
                        return <div className="text-center py-12 text-gray-500">ê²¬ì ì„œ ê´€ë¦¬ ê¸°ëŠ¥ ì¤€ë¹„ ì¤‘...</div>;
                    case 'contracts':
                        return <div className="text-center py-12 text-gray-500">ê³„ì•½ì„œ ê´€ë¦¬ ê¸°ëŠ¥ ì¤€ë¹„ ì¤‘...</div>;
                    case 'transactions':
                        return <div className="text-center py-12 text-gray-500">ê±°ë˜ëª…ì„¸ì„œ ê´€ë¦¬ ê¸°ëŠ¥ ì¤€ë¹„ ì¤‘...</div>;
                    default:
                        return <div className="text-center py-12 text-gray-500">í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>;
                }
            };

            if (!isInitialized) {
                return null;
            }

            return React.createElement(
                window.OCM_COMPONENTS.MainLayout,
                {
                    activeTab,
                    onTabChange: setActiveTab
                },
                renderContent()
            );
        };

        // ì „ì—­ ì•± ê°ì²´
        window.OCM_APP = {
            setActiveTab: (tab) => {
                // React ìƒíƒœ ì—…ë°ì´íŠ¸ëŠ” ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œë§Œ ê°€ëŠ¥
                console.log('íƒ­ ë³€ê²½ ìš”ì²­:', tab);
            }
        };

        console.log('âœ… Main Application ë¡œë“œ ì™„ë£Œ');
    </script>

    <!-- 7. Utility Functions -->
    <script>
        // ë¡œë”© ìŠ¤í¬ë¦° ì œì–´
        function updateProgress(message) {
            const progressEl = document.getElementById('loading-progress');
            if (progressEl) {
                progressEl.textContent = message;
            }
            console.log('â³', message);
        }

        function hideLoadingScreen() {
            const loadingScreen = document.getElementById('loading-screen');
            const rootEl = document.getElementById('root');
            
            if (loadingScreen && rootEl) {
                loadingScreen.style.display = 'none';
                rootEl.classList.remove('hidden');
            }
        }

        function showError(message) {
            const errorContainer = document.getElementById('error-container');
            const errorMessage = document.getElementById('error-message');
            const loadingScreen = document.getElementById('loading-screen');
            
            if (errorContainer && errorMessage) {
                errorMessage.textContent = message;
                errorContainer.classList.remove('hidden');
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
            }
        }

        // ë””ë²„ê·¸ ë„êµ¬
        window.OCM_DEBUG = {
            checkStatus: () => {
                console.log('=== OCM v2.0 ì‹œìŠ¤í…œ ìƒíƒœ ===');
                console.log('Config:', !!window.OCM_CONFIG);
                console.log('Constants:', !!window.OCM_CONSTANTS);
                console.log('Storage Manager:', !!window.OCM_STORAGE_MANAGER);
                console.log('Components:', Object.keys(window.OCM_COMPONENTS || {}));
                console.log('Clients:', window.OCM_STORAGE_MANAGER?.get('clients')?.count() || 0);
            },
            
            resetData: () => {
                if (confirm('ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    localStorage.clear();
                    location.reload();
                }
            },

            addSampleData: () => {
                const clientStorage = window.OCM_STORAGE_MANAGER?.get('clients');
                if (!clientStorage) return;

                try {
                    clientStorage.create({
                        companyName: 'ìƒ˜í”Œ íšŒì‚¬',
                        contactPerson: 'í™ê¸¸ë™',
                        email: 'sample@example.com',
                        phone: '02-1234-5678',
                        clientType: 'corporate'
                    });
                    console.log('âœ… ìƒ˜í”Œ ë°ì´í„° ì¶”ê°€ ì™„ë£Œ');
                    location.reload();
                } catch (error) {
                    console.error('ìƒ˜í”Œ ë°ì´í„° ì¶”ê°€ ì‹¤íŒ¨:', error);
                }
            }
        };

        // ì „ì—­ ì—ëŸ¬ ì²˜ë¦¬
        window.addEventListener('error', (event) => {
            console.error('ì „ì—­ ì˜¤ë¥˜:', event.error);
            showError('ì‹œìŠ¤í…œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + event.error.message);
        });

        console.log('âœ… ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ë¡œë“œ ì™„ë£Œ');
    </script>

    <!-- 8. Application Bootstrap -->
    <script type="text/babel">
        // ì•± ì‹œì‘
        function startApp() {
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(React.createElement(MainApp));
        }

        // DOM ë¡œë“œ ì™„ë£Œ í›„ ì•± ì‹œì‘
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ OCM v2.0 ì‹œìŠ¤í…œ ì‹œì‘');
            startApp();
        });
    </script>
</body>
</html>
